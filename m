Return-Path: <linux-remoteproc-owner@vger.kernel.org>
X-Original-To: lists+linux-remoteproc@lfdr.de
Delivered-To: lists+linux-remoteproc@lfdr.de
Received: from out1.vger.email (out1.vger.email [IPv6:2620:137:e000::1:20])
	by mail.lfdr.de (Postfix) with ESMTP id 3903F762FFD
	for <lists+linux-remoteproc@lfdr.de>; Wed, 26 Jul 2023 10:38:10 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S233171AbjGZIiI (ORCPT <rfc822;lists+linux-remoteproc@lfdr.de>);
        Wed, 26 Jul 2023 04:38:08 -0400
Received: from lindbergh.monkeyblade.net ([23.128.96.19]:43054 "EHLO
        lindbergh.monkeyblade.net" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S231811AbjGZIhi (ORCPT
        <rfc822;linux-remoteproc@vger.kernel.org>);
        Wed, 26 Jul 2023 04:37:38 -0400
Received: from mail-ej1-x62e.google.com (mail-ej1-x62e.google.com [IPv6:2a00:1450:4864:20::62e])
        by lindbergh.monkeyblade.net (Postfix) with ESMTPS id 3E1894223
        for <linux-remoteproc@vger.kernel.org>; Wed, 26 Jul 2023 01:26:24 -0700 (PDT)
Received: by mail-ej1-x62e.google.com with SMTP id a640c23a62f3a-98dfb3f9af6so1082596666b.2
        for <linux-remoteproc@vger.kernel.org>; Wed, 26 Jul 2023 01:26:24 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20221208; t=1690359983; x=1690964783;
        h=cc:to:subject:message-id:date:from:mime-version:from:to:cc:subject
         :date:message-id:reply-to;
        bh=+4r1BocHfH+Z9+5R2570iJZFBmUgNfGykXJ0u2VjoCs=;
        b=A07wlMD6ISS2ya0KQy/Yahv98AjjW6HjH5lhutF4aT62wObfYhXrvhN/o97bGRGhu3
         ZSB+6o++DxMjOVtlbYoyT1GjczkeF1iPGGzxP8IvdWC56wPyy6V4Z8+lJGwn/iKI9fws
         K5B04fTtLAc83y6KDIBUmuGAQsRoogGkRekCzyNhHTDDIMxvDb9794DRjNrmncg7DGsb
         vHUdmAyF9u0xSAHxvMJWCSZc6TRoU/Oz3fdBgy9T8RMIe6mCIoTI/6gNBa/SgUKB8VlQ
         OOdaZzEWlWWQZhjdtScnZt7YxhSU3s4k8ckFTZuSuoHzdU2vkQQbl8Q7R0UOQQqb0W6M
         k4hw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20221208; t=1690359983; x=1690964783;
        h=cc:to:subject:message-id:date:from:mime-version:x-gm-message-state
         :from:to:cc:subject:date:message-id:reply-to;
        bh=+4r1BocHfH+Z9+5R2570iJZFBmUgNfGykXJ0u2VjoCs=;
        b=Zir1lMu9WoDTEpQ2AI29GJOasoMTL1fBXyLQ37RGcygR/X64eds5CXL1FBp88U196f
         MTNToCR95/WlC4tx+tT2yiprkBYucFnrq9xhZYkwc0U++Cke3W4j+PrlQgoXUZX9NNt+
         IBppCVymNWBVrhoElv69eFzVTQ6cvDfIubiKfBEiQ2UBj4cHQ5ENEIdrcynQszf4La/I
         P+RGp1rUhj1oy9MwVtHqRiLqqUhMiphCG9xPxpV6O80X3dVn+xnUh4FrE/tRO+lHcWoG
         fG0YloImLlcN7mqwAfGl/s3M17gz1vyTICVrihZV1qhwOU5fDBMAcbq9uOc6OGWQhACl
         3Apw==
X-Gm-Message-State: ABy/qLZ29RQExS0rf5V7XvAjQiV3azWpux9K44OtVPgFejJSb1DJlcq/
        u9Bzx47QeqZf1250baF1XZqb6X0HoAB03hwh7EE=
X-Google-Smtp-Source: APBJJlHjueJwMYskgzRmqBP8QYhTaBx13hgxjzP8QwkS8+0j+xlI38UaVIdDa4JUxHBabZXizM9WYZTR+1jBjDPzKx8=
X-Received: by 2002:a17:907:a056:b0:993:e691:6dd5 with SMTP id
 gz22-20020a170907a05600b00993e6916dd5mr1184648ejc.7.1690359982480; Wed, 26
 Jul 2023 01:26:22 -0700 (PDT)
MIME-Version: 1.0
From:   Daniel Baluta <daniel.baluta@gmail.com>
Date:   Wed, 26 Jul 2023 11:26:10 +0300
Message-ID: <CAEnQRZAHzbCBuYvyTxzLJWmEUw4ytY+F8i_Qk0O9Z3ZW0L1bOg@mail.gmail.com>
Subject: Discussion about imx_dsp_rproc FW_READY policy
To:     Mathieu Poirier <mathieu.poirier@linaro.org>,
        "S.j. Wang" <shengjiu.wang@nxp.com>
Cc:     Iuliana Prodan <iuliana.prodan@nxp.com>,
        linux-remoteproc@vger.kernel.org, dl-linux-imx <linux-imx@nxp.com>,
        Laurentiu Mihalcea <laurentiu.mihalcea@nxp.com>
Content-Type: text/plain; charset="UTF-8"
X-Spam-Status: No, score=-2.1 required=5.0 tests=BAYES_00,DKIM_SIGNED,
        DKIM_VALID,DKIM_VALID_AU,DKIM_VALID_EF,FREEMAIL_FROM,
        RCVD_IN_DNSWL_NONE,SPF_HELO_NONE,SPF_PASS,T_SCC_BODY_TEXT_LINE,
        URIBL_BLOCKED autolearn=ham autolearn_force=no version=3.4.6
X-Spam-Checker-Version: SpamAssassin 3.4.6 (2021-04-09) on
        lindbergh.monkeyblade.net
Precedence: bulk
List-ID: <linux-remoteproc.vger.kernel.org>
X-Mailing-List: linux-remoteproc@vger.kernel.org

Hello all,

I want to start this thread in order to clarify what assumptions a
remoteproc driver is able to make
about a firmware loaded on a remote processor.

Discussion is generated by this thread:

[1] https://www.spinics.net/lists/kernel/msg4857733.html

imx_dsp_rproc driver assumes that the remote firmware will send a
notification once it has booted up and this is the default behavior.

This doesn't work well with Zephyr samples which do not send such notification!

I want to get an agreement for the following questions:

1) What should be the default behavior of a remote proc driver?

In my opinion it should not make any assumption about the remote part.
Thus by default the driver should not wait for any message!

2) How can we support various "protocols" of starting up. Eg (wait for
firmware / no wait for firmware).

In patch [1] Iulia proposed to add a flag that will select the correct
behavior. As per Mathieu's comments this doesn't
scale up, for next flags.

How can we solve this? In my opinion using a kernel module parameter
OR a device tree property should be enough.

What do you think?

thanks,
Daniel.
